<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MNYC Work Management Tool</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.4.0/css/all.css" />
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<!-- Loading Screen -->
<div class="loading-screen" id="loadingScreen">
  <div class="loading-content">
    <div class="loading-spinner">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <i class="fas fa-briefcase loading-icon"></i>
    </div>
    <h1 class="loading-text">Your Tool is Loading</h1>
    <div class="loading-dots">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
</div>

<!-- Login Screen -->
<div class="login-screen" id="loginScreen" style="display: none;">
  <div class="login-container">
    <div class="login-header">
      <i class="fas fa-briefcase"></i>
      <h1>MNYC Work Management</h1>
      <p>Daily Claim Workforce Management</p>
    </div>
    <div class="login-form">
      <div class="form-group">
        <label><i class="fas fa-id-badge"></i> Username</label>
        <input type="text" id="loginId" placeholder="Enter your username" />
      </div>
      <div class="form-group">
        <label><i class="fas fa-lock"></i> Password</label>
        <input type="password" id="loginPassword" placeholder="Enter your password" onkeypress="if(event.key==='Enter')handleLogin()" />
      </div>
      <div class="login-error" id="loginError" style="display: none;">
        <i class="fas fa-exclamation-circle"></i>
        <span id="loginErrorText">Invalid credentials</span>
      </div>
      <button type="button" class="btn btn-primary btn-full" id="loginBtn" onclick="handleLogin()">
        <i class="fas fa-sign-in-alt"></i> Login
      </button>
    </div>
  </div>
</div>

<!-- Main App (Hidden until login) -->
<div class="app-container" id="appContainer" style="display: none;">

<!-- Header -->
<header class="header">
  <div class="header-content">
    <div class="logo">
      <i class="fas fa-briefcase"></i>
      <div>
        <h1>MNYC Work Management</h1>
        <p>Daily Claim Workforce Management</p>
      </div>
    </div>
    <div class="user-info">
      <div class="user-details">
        <span class="user-name" id="userName"></span>
        <span class="user-role" id="userRole"></span>
      </div>
      <div class="user-avatar" id="userAvatar" onclick="openProfileModal()" title="Edit Profile"></div>
      <button class="btn btn-outline btn-sm" id="profileBtn" onclick="openProfileModal()" style="display: none;">
        <i class="fas fa-user-cog"></i> Profile
      </button>
      <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle Dark Mode">
        <i class="fas fa-moon" id="themeIcon"></i>
      </button>
      <button class="btn btn-secondary" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i> Logout
      </button>
    </div>
  </div>
</header>

<!-- Admin Controls (Only visible to admin) -->
<div class="admin-controls" id="adminControls" style="display: none;">
  <div class="admin-header">
    <h2><i class="fas fa-user-shield"></i> Admin Dashboard</h2>
    <div class="admin-actions">
      <button class="btn btn-primary" onclick="openCreateUserModal()">
        <i class="fas fa-user-plus"></i> Create User
      </button>
      <button class="btn btn-primary" onclick="openManageUsersModal()">
        <i class="fas fa-users-cog"></i> Manage Users
      </button>
      <button class="btn btn-outline" onclick="refreshData()">
        <i class="fas fa-sync-alt"></i> Refresh
      </button>
      <button class="btn btn-outline" onclick="openImportModal()">
        <i class="fas fa-file-excel"></i> Import Excel
      </button>
      <button class="btn btn-outline" onclick="exportData()">
        <i class="fas fa-download"></i> Export Data
      </button>
      <button class="btn btn-outline" onclick="addNewClaim()">
        <i class="fas fa-plus"></i> Add Claim
      </button>
      <button class="btn btn-primary" onclick="openAgentReporting()" style="margin-left: 15px; border-left: 1px solid rgba(255,255,255,0.2); padding-left: 15px;">
        <i class="fas fa-chart-line"></i> Agent Reports
      </button>
    </div>
  </div>
  
  <!-- Employee Overview Cards -->
  <div class="employee-carousel-wrapper">
    <button class="carousel-arrow carousel-prev" id="empCarouselPrev" onclick="scrollEmployeeCards(-1)">
      <i class="fas fa-chevron-left"></i>
    </button>
    <div class="employee-overview" id="employeeCardsContainer">
      <!-- Employee cards will be dynamically generated -->
    </div>
    <button class="carousel-arrow carousel-next" id="empCarouselNext" onclick="scrollEmployeeCards(1)">
      <i class="fas fa-chevron-right"></i>
    </button>
  </div>
  <div class="carousel-dots" id="carouselDots"></div>
</div>

<!-- Agent Header (Only visible to agents) -->
<div class="agent-header" id="agentHeader" style="display: none;">
  <div class="agent-queue-tabs">
    <button class="queue-tab active" data-queue="my" onclick="setAgentQueue('my')">
      <i class="fas fa-user"></i> My Queue
    </button>
    <button class="queue-tab" data-queue="shared" onclick="setAgentQueue('shared')">
      <i class="fas fa-share-alt"></i> Shared With Me
    </button>
    <button class="queue-tab" data-queue="all" onclick="setAgentQueue('all')">
      <i class="fas fa-users"></i> All Claims
    </button>
  </div>
  <div class="agent-actions">
    <select class="agent-filter" id="agentQueueFilter" onchange="filterClaims()" style="display: none;">
      <option value="all">All Agents</option>
      <option value="EMP001">Shubham's Queue</option>
      <option value="EMP002">Ravi's Queue</option>
      <option value="EMP003">Chirag's Queue</option>
    </select>
    <button class="btn btn-outline" onclick="refreshData()">
      <i class="fas fa-sync-alt"></i> Refresh
    </button>
    <button class="btn btn-outline" onclick="exportData()">
      <i class="fas fa-download"></i> Export
    </button>
    <button class="btn btn-primary" onclick="openMyReporting()" style="margin-left: 15px; border-left: 1px solid rgba(255,255,255,0.2); padding-left: 15px;">
      <i class="fas fa-chart-line"></i> My Report
    </button>
  </div>
</div>

<!-- Stats Dashboard -->
<div class="stats-container">
  <div class="stat-card" id="allClaimsCard" title="Hover to see upload dates">
    <div class="stat-icon stat-icon-blue">
      <i class="fas fa-file-invoice"></i>
    </div>
    <div class="stat-info">
      <span class="stat-value" id="totalClaims">0</span>
      <span class="stat-label" id="totalLabel">Total Claims</span>
    </div>
  </div>
  <div class="stat-card clickable-card" onclick="openCardModal('pending')">
    <div class="stat-icon stat-icon-yellow">
      <i class="fas fa-clock"></i>
    </div>
    <div class="stat-info">
      <span class="stat-value" id="pendingClaims">0</span>
      <span class="stat-label">Pending</span>
    </div>
  </div>
  <div class="stat-card clickable-card" onclick="openCardModal('paid')">
    <div class="stat-icon stat-icon-green">
      <i class="fas fa-check-circle"></i>
    </div>
    <div class="stat-info">
      <span class="stat-value" id="paidClaims">0</span>
      <span class="stat-label">Paid</span>
    </div>
  </div>
  <div class="stat-card clickable-card" onclick="openCardModal('overdue')">
    <div class="stat-icon stat-icon-red">
      <i class="fas fa-exclamation-triangle"></i>
    </div>
    <div class="stat-info">
      <span class="stat-value" id="overdueClaims">0</span>
      <span class="stat-label">Overdue</span>
    </div>
  </div>
</div>

<!-- Filter Bar -->
<div class="filter-bar">
  <div class="search-box">
    <i class="fas fa-search"></i>
    <input type="text" id="searchInput" placeholder="Search claims..." onkeyup="filterClaims()">
  </div>
  <div class="filter-group">
    <div class="filter-buttons">
      <button class="filter-btn active" data-filter="all" onclick="setFilter('all')">All</button>
      <button class="filter-btn" data-filter="P-1" onclick="setFilter('P-1')">P-1</button>
      <button class="filter-btn" data-filter="P-2" onclick="setFilter('P-2')">P-2</button>
      <button class="filter-btn" data-filter="CHERRY" onclick="setFilter('CHERRY')">CHERRY</button>
    </div>
    <select class="agent-filter" id="agentFilter" onchange="filterClaims()" style="display: none;">
      <option value="all">All Agents</option>
      <!-- Agent options will be populated dynamically -->
      <option value="unassigned">Unassigned</option>
    </select>
  </div>
</div>

<!-- Bulk Action Bar (Admin Only) -->
<div class="bulk-action-bar" id="bulkActionBar" style="display: none;">
  <div class="bulk-select-info">
    <input type="checkbox" id="selectAllClaims" onchange="toggleSelectAll()" />
    <span id="selectedCount">0</span> claims selected
  </div>
  <div class="bulk-actions">
    <button class="btn btn-warning" onclick="openBulkAssignModal()">
      <i class="fas fa-user-plus"></i> Assign Selected
    </button>
    <button class="btn btn-danger" onclick="bulkDelete()">
      <i class="fas fa-trash"></i> Delete Selected
    </button>
    <button class="btn btn-secondary" onclick="clearSelection()">
      <i class="fas fa-times"></i> Clear Selection
    </button>
  </div>
</div>

<!-- Claims Table -->
<div class="card">
  <div class="card-header">
    <h2><i class="fas fa-list"></i> Claims List</h2>
    <span class="badge" id="claimCount">0 claims</span>
  </div>
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th class="checkbox-col" id="checkboxHeader" style="display: none;">
            <input type="checkbox" id="selectAllHeader" onchange="toggleSelectAll()" title="Select All" />
          </th>
          <th>Claim #</th>
          <th>Patient</th>
          <th>Balance</th>
          <th>Priority</th>
          <th>Assigned To</th>
          <th>Status</th>
          <th>Date Worked</th>
          <th>Next Follow-Up</th>
          <th>History</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="claimsBody"></tbody>
    </table>
  </div>
  <div class="empty-state" id="emptyState" style="display: none;">
    <i class="fas fa-inbox"></i>
    <p>No claims found</p>
  </div>
  
  <!-- Pagination -->
  <div class="pagination-container" id="paginationContainer"></div>
</div>

</div><!-- End App Container -->

<!-- Work Modal -->
<div class="modal-backdrop" id="modal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-edit"></i> Work Claim</h3>
      <button class="btn-close" onclick="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="claim-summary" id="claimSummary"></div>

    <div class="form-group">
      <label><i class="fas fa-comment"></i> Remarks <span class="required">*</span></label>
      <textarea id="remarksInput" rows="3" placeholder="Enter your notes about this claim..." required></textarea>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label><i class="fas fa-tag"></i> Status <span class="required">*</span></label>
        <select id="statusInput" required>
          <option value="">-- Select Status --</option>
          <option value="ADED">ADED</option>
          <option value="BMAX">BMAX</option>
          <option value="CAP">CAP</option>
          <option value="CNOF">CNOF</option>
          <option value="DCOB">DCOB</option>
          <option value="DCRE">DCRE</option>
          <option value="DFMR">DFMR</option>
          <option value="DMNC">DMNC</option>
          <option value="DMOD">DMOD</option>
          <option value="DPOS">DPOS</option>
          <option value="DTFL">DTFL</option>
          <option value="DUP">DUP</option>
          <option value="ICPT">ICPT</option>
          <option value="IICD">IICD</option>
          <option value="INCLSV">INCLSV</option>
          <option value="INEL">INEL</option>
          <option value="INPRCS">INPRCS</option>
          <option value="MISC">MISC</option>
          <option value="NATH">NATH</option>
          <option value="NCOV">NCOV</option>
          <option value="NON_PAR">NON_PAR</option>
          <option value="OTHER_INS_PRIM">OTHER_INS_PRIM</option>
          <option value="PAID">PAID</option>
          <option value="PAID_TO_OTHER_PROV">PAID_TO_OTHER_PROV</option>
          <option value="PEOB">PEOB</option>
          <option value="PPMAX">PPMAX</option>
          <option value="PPAY">PPAY</option>
          <option value="PRSB">PRSB</option>
          <option value="RCNT">RCNT</option>
          <option value="REFP">REFP</option>
          <option value="REFUND">REFUND</option>
          <option value="REJECTED">REJECTED</option>
          <option value="SMALL_BAL">SMALL_BAL</option>
        </select>
      </div>
      <div class="form-group">
        <label><i class="fas fa-tasks"></i> Action Taken <span class="required">*</span></label>
        <select id="actionTakenInput" required>
          <option value="">-- Select Action --</option>
          <option value="ADJUSTED">ADJUSTED</option>
          <option value="AFX">AFX</option>
          <option value="ALWTM">ALWTM</option>
          <option value="AMLD">AMLD</option>
          <option value="BILLED_PT">Billed Pt</option>
          <option value="CDNG_ISSUE">CDNG ISSUE</option>
          <option value="ESCALATED">ESCALATED</option>
          <option value="MRDS">MRDS</option>
          <option value="ONSHORE">ONSHORE</option>
          <option value="PENDING">PENDING</option>
          <option value="POSTED">POSTED</option>
          <option value="RBLD">RBLD</option>
          <option value="RBLD_ON_PAPER">RBLD ON PAPER</option>
          <option value="RCPD">RCPD</option>
          <option value="REFUND_REQUEST_ESCALATED">REFUND REQUEST ESCALATED</option>
          <option value="REPRCD">REPRCD</option>
          <option value="URPT">URPT</option>
          <option value="VOICEMAIL">VOICEMAIL</option>
          <option value="WRITE_OFF_REC">WRITE OFF REC.</option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label><i class="fas fa-calendar"></i> Follow-Up Days</label>
        <input type="number" id="followUpDays" min="1" max="90" value="14" />
      </div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" id="cancelBtn" onclick="closeModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn btn-primary" id="saveBtn">
        <i class="fas fa-save"></i> Save Changes
      </button>
    </div>
  </div>
</div>

<!-- History Modal -->
<div class="modal-backdrop" id="historyModal">
  <div class="modal modal-large">
    <div class="modal-header">
      <h3><i class="fas fa-history"></i> Follow-Up History</h3>
      <button class="btn-close" onclick="closeHistoryModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="claim-summary" id="historyClaimSummary"></div>
    
    <div class="history-timeline" id="historyTimeline">
      <!-- History entries will be populated here -->
    </div>
    
    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeHistoryModal()">
        <i class="fas fa-times"></i> Close
      </button>
    </div>
  </div>
</div>

<!-- Add New Claim Modal -->
<div class="modal-backdrop" id="addClaimModal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-plus-circle"></i> Add New Claim</h3>
      <button class="btn-close" onclick="closeAddClaimModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="form-group">
      <label><i class="fas fa-hashtag"></i> Claim Number</label>
      <input type="text" id="newClaimNo" placeholder="e.g., CLM003" />
    </div>

    <div class="form-group">
      <label><i class="fas fa-user"></i> Patient Name</label>
      <input type="text" id="newPatient" placeholder="Enter patient name" />
    </div>

    <div class="form-group">
      <label><i class="fas fa-dollar-sign"></i> Balance</label>
      <input type="number" id="newBalance" placeholder="Enter balance amount" min="0" step="0.01" />
    </div>

    <div class="form-group">
      <label><i class="fas fa-user-tie"></i> Assign To</label>
      <select id="newAssignee">
        <option value="">-- Select Agent --</option>
        <option value="EMP001">Shubham (EMP001)</option>
        <option value="EMP002">Ravi (EMP002)</option>
        <option value="EMP003">Chirag (EMP003)</option>
      </select>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeAddClaimModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn btn-primary" onclick="saveNewClaim()">
        <i class="fas fa-plus"></i> Add Claim
      </button>
    </div>
  </div>
</div>

<!-- Import Excel Modal -->
<div class="modal-backdrop" id="importModal">
  <div class="modal modal-large">
    <div class="modal-header">
      <h3><i class="fas fa-file-excel"></i> Import Claims from Excel</h3>
      <button class="btn-close" onclick="closeImportModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="import-instructions">
      <h4><i class="fas fa-info-circle"></i> File Format Instructions</h4>
      <p>Your Excel file should have the following columns:</p>
      <div class="column-list">
        <span class="column-tag">ClaimNo</span>
        <span class="column-tag">Patient</span>
        <span class="column-tag">Balance</span>
        <span class="column-tag">Priority</span>
        <span class="column-tag">Age</span>
        <span class="column-tag">AgeBucket</span>
        <span class="column-tag">AssignTo (optional)</span>
      </div>
      <p><small>Priority values: P-1, P-2, CHERRY | AssignTo: EMP001, EMP002, EMP003</small></p>
    </div>

    <div class="file-upload-area" id="fileUploadArea">
      <i class="fas fa-cloud-upload-alt"></i>
      <p>Drag & drop your Excel file here</p>
      <span>or</span>
      <label class="btn btn-primary">
        <i class="fas fa-folder-open"></i> Browse Files
        <input type="file" id="excelFileInput" accept=".xlsx,.xls,.csv" onchange="handleFileSelect(event)" hidden />
      </label>
    </div>

    <div class="import-preview" id="importPreview" style="display: none;">
      <h4><i class="fas fa-table"></i> Preview (<span id="previewCount">0</span> claims)</h4>
      <div class="preview-table-wrapper">
        <table class="preview-table">
          <thead>
            <tr>
              <th>Claim #</th>
              <th>Patient</th>
              <th>Balance</th>
              <th>Assign To</th>
            </tr>
          </thead>
          <tbody id="previewBody"></tbody>
        </table>
      </div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeImportModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn btn-primary" id="importBtn" onclick="importClaims()" disabled>
        <i class="fas fa-upload"></i> Import Claims
      </button>
    </div>
  </div>
</div>

<!-- Assign Modal -->
<div class="modal-backdrop" id="assignModal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-user-plus"></i> Assign Claim</h3>
      <button class="btn-close" onclick="closeAssignModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="claim-summary" id="assignClaimSummary"></div>

    <div class="form-group">
      <label><i class="fas fa-user-tie"></i> Assign To Agent</label>
      <select id="assignAgentSelect">
        <option value="">-- Select Agent --</option>
        <!-- Agent options will be populated dynamically -->
      </select>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeAssignModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn btn-primary" onclick="saveAssignment()">
        <i class="fas fa-check"></i> Assign
      </button>
    </div>
  </div>
</div>

<!-- Share Modal -->
<div class="modal-backdrop" id="shareModal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-share-alt"></i> Share Claim</h3>
      <button class="btn-close" onclick="closeShareModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="claim-summary" id="shareClaimSummary"></div>

    <div class="share-info">
      <i class="fas fa-info-circle"></i>
      <p>Sharing allows other agents to work on this claim when you're unavailable. They can view all history and add their own updates.</p>
    </div>

    <div class="form-group">
      <label><i class="fas fa-users"></i> Share With Agents</label>
      <div class="share-checkboxes" id="shareCheckboxes">
        <!-- Checkboxes will be populated dynamically -->
      </div>
    </div>

    <div class="current-shares" id="currentShares" style="display: none;">
      <label><i class="fas fa-user-friends"></i> Currently Shared With</label>
      <div id="currentSharesList"></div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeShareModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn btn-primary" onclick="saveShare()">
        <i class="fas fa-share"></i> Update Sharing
      </button>
    </div>
  </div>
</div>

<!-- Claim Detail Modal -->
<div class="modal-backdrop" id="detailModal">
  <div class="modal modal-large">
    <div class="modal-header">
      <h3><i class="fas fa-file-medical"></i> Claim Details</h3>
      <button class="btn-close" onclick="closeDetailModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="detail-content" id="detailContent">
      <!-- Will be populated dynamically -->
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeDetailModal()">
        <i class="fas fa-times"></i> Close
      </button>
      <button class="btn btn-primary" id="detailWorkBtn" onclick="workFromDetail()">
        <i class="fas fa-edit"></i> Work on Claim
      </button>
    </div>
  </div>
</div>

<!-- Bulk Assign Modal -->
<div class="modal-backdrop" id="bulkAssignModal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-users-cog"></i> Bulk Assign Claims</h3>
      <button class="btn-close" onclick="closeBulkAssignModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="bulk-assign-info">
      <div class="bulk-count-badge">
        <i class="fas fa-file-invoice"></i>
        <span id="bulkAssignCount">0</span> claims selected
      </div>
    </div>

    <div class="form-group">
      <label><i class="fas fa-user-tie"></i> Assign All To</label>
      <select id="bulkAssignAgentSelect">
        <option value="">-- Select Agent --</option>
        <!-- Agent options will be populated dynamically -->
      </select>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeBulkAssignModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn btn-primary" onclick="saveBulkAssignment()">
        <i class="fas fa-check"></i> Assign All
      </button>
    </div>
  </div>
</div>

<!-- Create User Modal (Admin) -->
<div class="modal-backdrop" id="createUserModal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-user-plus"></i> Create New User</h3>
      <button class="btn-close" onclick="closeCreateUserModalAndRefresh()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="create-user-content">
      <!-- Success Message -->
      <div class="user-created-success" id="userCreatedSuccess" style="display: none;">
        <div class="success-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <h4>User Created Successfully!</h4>
        <p id="createdUserName">User has been added to the system.</p>
        <div class="success-actions">
          <button class="btn btn-secondary" onclick="finishCreateUser()">
            <i class="fas fa-check"></i> Done
          </button>
          <button class="btn btn-primary" onclick="resetCreateUserForm()">
            <i class="fas fa-plus"></i> Create Another User
          </button>
        </div>
      </div>
      
      <!-- Create User Form -->
      <form id="createUserForm" onsubmit="createNewUser(event)">
        <div class="form-group">
          <label><i class="fas fa-user"></i> Username <span class="required">*</span></label>
          <input type="text" id="newUsername" placeholder="Enter username (used for login)" required />
        </div>
        <div class="form-group">
          <label><i class="fas fa-id-badge"></i> Full Name <span class="required">*</span></label>
          <input type="text" id="newUserName" placeholder="Enter full name" required />
        </div>
        <div class="form-group">
          <label><i class="fas fa-envelope"></i> Email</label>
          <input type="email" id="newUserEmail" placeholder="Enter email (optional)" />
        </div>
        <div class="form-group">
          <label><i class="fas fa-lock"></i> Password <span class="required">*</span></label>
          <input type="password" id="newUserPassword" placeholder="Enter password" required />
        </div>
        
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary" onclick="closeCreateUserModal()">
            <i class="fas fa-times"></i> Cancel
          </button>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-user-plus"></i> Create User
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Manage Users Modal (Admin) -->
<div class="modal-backdrop" id="manageUsersModal">
  <div class="modal modal-large">
    <div class="modal-header">
      <h3><i class="fas fa-users-cog"></i> Manage Users</h3>
      <button class="btn-close" onclick="closeManageUsersModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="manage-users-content">
      <div class="user-list-header">
        <span id="userCount">0 users</span>
        <button class="btn btn-sm btn-primary" onclick="closeManageUsersModal(); openCreateUserModal();">
          <i class="fas fa-user-plus"></i> Add New
        </button>
      </div>
      <div class="user-list" id="userList">
        <!-- Will be populated dynamically -->
      </div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeManageUsersModal()">
        <i class="fas fa-times"></i> Close
      </button>
    </div>
  </div>
</div>

<!-- Profile Modal (Agents) -->
<div class="modal-backdrop" id="profileModal">
  <div class="modal">
    <div class="modal-header">
      <h3><i class="fas fa-user-cog"></i> Edit Profile</h3>
      <button class="btn-close" onclick="closeProfileModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="profile-avatar-section">
      <div class="profile-avatar" id="profileAvatar"></div>
      <div class="profile-role" id="profileRole"></div>
    </div>
    
    <form id="profileForm" onsubmit="saveProfile(event)">
      <div class="form-group">
        <label><i class="fas fa-user"></i> Username</label>
        <input type="text" id="profileUsername" disabled />
        <small class="form-hint">Username cannot be changed</small>
      </div>
      <div class="form-group">
        <label><i class="fas fa-id-badge"></i> Full Name</label>
        <input type="text" id="profileName" placeholder="Enter your name" required />
      </div>
      <div class="form-group">
        <label><i class="fas fa-envelope"></i> Email</label>
        <input type="email" id="profileEmail" placeholder="Enter your email" />
      </div>
      
      <div class="password-change-section">
        <h4><i class="fas fa-key"></i> Change Password</h4>
        <div class="form-group">
          <label>Current Password</label>
          <input type="password" id="currentPassword" placeholder="Enter current password" />
        </div>
        <div class="form-group">
          <label>New Password</label>
          <input type="password" id="newPassword" placeholder="Enter new password" />
        </div>
        <div class="form-group">
          <label>Confirm New Password</label>
          <input type="password" id="confirmPassword" placeholder="Confirm new password" />
        </div>
      </div>
      
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" onclick="closeProfileModal()">
          <i class="fas fa-times"></i> Cancel
        </button>
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-save"></i> Save Changes
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Card View Modal (For Pending/Paid/Overdue) -->
<div class="modal-backdrop" id="cardViewModal">
  <div class="modal modal-large">
    <div class="modal-header">
      <h3><i class="fas fa-list"></i> <span id="cardModalTitle">Claims</span></h3>
      <button class="btn-close" onclick="closeCardModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="card-table-wrapper" id="cardTableWrapper" style="display: none;">
      <table class="card-table">
        <thead>
          <tr>
            <th>Claim #</th>
            <th>Patient</th>
            <th>Balance</th>
            <th>Priority</th>
            <th>Assigned To</th>
            <th id="extraColumn" style="display: none;"></th>
          </tr>
        </thead>
        <tbody id="cardTableBody">
          <!-- Will be populated dynamically -->
        </tbody>
      </table>
    </div>

    <div class="empty-state" id="emptyCardState" style="display: none;">
      <i class="fas fa-inbox"></i>
      <p>No claims found</p>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeCardModal()">
        <i class="fas fa-times"></i> Close
      </button>
    </div>
  </div>
</div>

<!-- Reporting Section (for both Admin and Agent) -->
<div id="reportingSection" style="display: none;">
  <div class="reporting-header">
    <div class="reporting-title">
      <i class="fas fa-chart-bar"></i>
      <h2 id="reportingSectionTitle">Agent Reports</h2>
    </div>
    <button class="btn btn-outline" onclick="closeReportingSection()">
      <i class="fas fa-arrow-left"></i> Back to Dashboard
    </button>
  </div>

  <div class="reporting-container">
    <!-- Agent Reports (Personal) -->
    <div id="agentReportingSection" style="display: none;">
      <div class="reporting-filters">
        <div class="filter-group">
          <label><i class="fas fa-calendar-alt"></i> Start Date</label>
          <input type="date" id="myReportingStartDate" />
        </div>
        <div class="filter-group">
          <label><i class="fas fa-calendar-alt"></i> End Date</label>
          <input type="date" id="myReportingEndDate" />
        </div>
        <div class="filter-group filter-actions">
          <button class="btn btn-primary" onclick="generateMyReportingData()">
            <i class="fas fa-play"></i> Generate Report
          </button>
          <button class="btn btn-secondary" onclick="clearMyReportingFilters()">
            <i class="fas fa-times"></i> Clear Filters
          </button>
        </div>
      </div>

      <!-- Advanced Filtering Stats -->
      <div class="advanced-filtering" id="advancedFiltersAgent" style="display: none;">
        <h3><i class="fas fa-chart-pie"></i> Quick Stats</h3>
        <div class="quick-stats-grid">
          <div class="quick-stat-box">
            <span class="quick-stat-label">Total Claims</span>
            <span class="quick-stat-number" id="myTotalClaimsCount">0</span>
          </div>
          <div class="quick-stat-box">
            <span class="quick-stat-label">Closed</span>
            <span class="quick-stat-number" id="myClosedCount">0</span>
          </div>
          <div class="quick-stat-box">
            <span class="quick-stat-label">Pending</span>
            <span class="quick-stat-number" id="myPendingCount">0</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Report Stats -->
    <div class="reporting-stats" id="reportingStats" style="display: none;">
      <div class="stat-box">
        <span class="stat-label">Total Claims Worked</span>
        <span class="stat-number" id="totalWorkedClaims">0</span>
      </div>
      <div class="stat-box">
        <span class="stat-label">Closed Claims</span>
        <span class="stat-number" id="closedClaimCount">0</span>
      </div>
      <div class="stat-box">
        <span class="stat-label">Open Claims</span>
        <span class="stat-number" id="openClaimCount">0</span>
      </div>
      <div class="stat-box">
        <span class="stat-label">Total Balance</span>
        <span class="stat-number" id="reportingTotalBalance">$0</span>
      </div>
    </div>

    <!-- Report Table -->
    <div class="reporting-table-wrapper" id="reportingTableWrapper" style="display: none;">
      <table class="reporting-table">
        <thead>
          <tr>
            <th>Claim #</th>
            <th>Patient</th>
            <th>Balance</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Assigned To</th>
            <th>Date Worked</th>
            <th>Next Follow-Up</th>
          </tr>
        </thead>
        <tbody id="reportingTableBody">
          <!-- Will be populated dynamically -->
        </tbody>
      </table>
    </div>

    <div class="empty-state" id="emptyReportingState" style="display: none;">
      <i class="fas fa-inbox"></i>
      <p>No claims found for the selected criteria</p>
    </div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>

